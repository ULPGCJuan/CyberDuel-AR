<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>WebXR + WebSocket</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js"></script>
    <script type="module" src="./main.js" defer></script>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>

    <div id="start-screen" class="screen-background">
      <div id="start-buttons">
        <button id="play-button">Jugar</button>
        <button id="instructions-button">Instrucciones</button>
      </div>
    </div>
  
    <div id="config-screen" class="screen-background" style="display: none;">
      <div class="content-box">
        <h2>Selecciona el nÃºmero de esferas</h2>
        <input type="range" id="sphere-count" min="4" max="31" value="15" />
        <div id="sphere-count-display">15 esferas</div>
        
        <p id="ready-message" style="margin-top: 10px; font-style: italic; color: #ccc;">
          âœ… Cuando estÃ©s en una zona segura y todo estÃ© listo,<br/>
          pulsa <strong>â€œStart ARâ€</strong> para comenzar.
        </p>
        
        <div id="start-game-button"></div>
        <button id="config-back-button">Volver</button>
      </div>
    </div>
  
    <div id="instructions-screen" class="screen-background" style="display: none;">
      <div class="content-box">
        <p>
          <strong>Â¿CÃ³mo se juega?</strong><br/>
          En <strong>CyberDuel AR</strong> deberÃ¡s encontrar y tocar esferas en tu entorno real.<br/>
          Cada esfera activarÃ¡ un <strong>minijuego aleatorio</strong> que deberÃ¡s completar para ganar un punto.<br/>
          El objetivo es conseguir la <strong>mayorÃ­a de esferas</strong> para ganar la partida.
        </p>

        <p>
          Cada jugador tiene asignadas <strong>esferas de su color</strong> (azul, rojo o amarillo) que solo Ã©l puede completar.<br/>
          Para poder acceder a las <strong>esferas neutrales</strong> (blancas), primero debes completar todas tus esferas de color.<br/>
          Las esferas neutrales cambian de color segÃºn el primer jugador que las complete.
        </p>

        <p>
          Puedes <strong>tocar las esferas de color de otros jugadores</strong>, pero no podrÃ¡s completarlas.<br/>
          En su lugar, se moverÃ¡n a una posiciÃ³n aleatoria, haciÃ©ndoles mÃ¡s difÃ­cil alcanzarlas.
        </p>

        <p>
          <strong>Tipos de minijuegos:</strong><br/>
          - <em>Toca 20 veces</em>: pulsa la pantalla rÃ¡pidamente hasta llegar a 20 toques.<br/>
          - <em>Introduce el cÃ³digo</em>: memoriza y escribe un cÃ³digo aleatorio de 8 caracteres.<br/>
          - <em>Resuelve una suma</em>: responde correctamente una operaciÃ³n sencilla.<br/>
          - <em>MantÃ©n presionado</em>: mantÃ©n pulsado un botÃ³n durante varios segundos.<br/>
          - <em>Elige el sÃ­mbolo correcto</em>: toca el sÃ­mbolo indicado entre varios botones.<br/>
          - <em>Â¡NO ME TOQUES!</em>: aparece un gran botÃ³n... pero no debes tocarlo.<br/>
          - <em>Trivia</em>: responde preguntas cortas de cultura general.
        </p>

        <p>
          <strong>Consejo:</strong><br/>
          Â¡Presta atenciÃ³n y actÃºa rÃ¡pido! Algunos minijuegos se reinician si fallas.
        </p>

        <p style="font-style: italic; color: #ccc;">
          ğŸ” Nota: Antes de comenzar el juego, colÃ³cate cerca de una pared o Ã¡rea amplia y libre de obstÃ¡culos.<br/>
          El juego requiere espacio suficiente para colocar las esferas en tu entorno AR.
        </p>

        <button id="back-button">Volver</button>
      </div>
    </div>


    <div id="waiting-overlay" style="display: none;">
      <div class="waiting-box">
        <p>ğŸ•’ Esperando a que se unan jugadores...</p>

        <div id="waiting-status" style="color:white; margin-top:10px;"></div>

        <div id="player-role-info" style="color:white; margin-top:8px;" ></div>
        <button id="start-match-button" style="display:none; margin-top:15px;">
          Iniciar partida
        </button>
      </div>
    </div>

    <div id="minigame-container"></div>
    <div id="progress-wrapper" style="display: none;">
      <div id="player-progress" class="score-grid"></div>
    </div>
    
    <div id="win-screen" style="display: none;">
      <div id="win-message">
        <h2>ğŸ‰ Â¡Has ganado!</h2>
        <p>Has tocado suficientes esferas y superado los minijuegos.</p>
        <p>Gracias por jugar a <strong>CyberDuel AR</strong>.<br/> Esperamos que te hayas divertido.</p>
      </div>
    </div>
  </body>
</html>
